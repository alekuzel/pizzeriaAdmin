"use strict";var form={email:document.querySelector("#email"),password:document.querySelector("#password"),submit:document.querySelector("#submit")},button=form.submit.addEventListener("click",(function(t){t.preventDefault();fetch("http://localhost/3WProject/projekt_webservice_vt23-alekuzel/restlogin.php",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({email:form.email.value,password:form.password.value})}).then((function(t){return t.json()})).then((function(t){console.log(t),t.error?alert("Error Password or Username"):window.open("index.html")})).catch((function(t){console.log(t)}))})),urlA="http://localhost/3WProject/projekt_webservice_vt23-alekuzel/restMenu.php",urlB="http://localhost/3WProject/projekt_webservice_vt23-alekuzel/restBooking.php",mealNameInput=document.getElementById("mealName"),categoryInput=document.getElementById("category"),priceInput=document.getElementById("price"),descriptionInput=document.getElementById("description"),submitInput=document.getElementById("submit");function init(){getMenu(),getBookings()}function getMenu(){fetch(urlA).then((function(t){if(200==t.status)return t.json().then((function(t){return displayMenu(t)}))}))}function addMeal(t){t.preventDefault();var e=mealNameInput.value,n=categoryInput.value,o=priceInput.value,c=descriptionInput.value,d=JSON.stringify({name:e,description:c,category:n,price:o});fetch(urlA,{method:"POST",headers:{"content-type":"application/json"},body:d}).then((function(t){return t.json()})).then((function(t){return clearForm()}))}function getBookings(){fetch(urlB).then((function(t){if(200==t.status)return t.json().then((function(t){return displayBookings(t)}))}))}function displayBookings(t){var e=document.getElementById("bookingsTable");e.innerHTML="",t.forEach((function(t){e.innerHTML+='<tr>\n    <td id="clientsname'.concat(t.id,'">').concat(t.name,'</td>\n    <td id="clientslastname').concat(t.id,'">').concat(t.lastname,'</td>\n    <td id="phone').concat(t.id,'">').concat(t.phone,'</td>\n    <td id="email').concat(t.id,'">').concat(t.email,'</td>\n    <td id="date').concat(t.id,'" contenteditable>').concat(t.date,'</td>\n    <td id="time').concat(t.id,'" contenteditable>').concat(t.time,'</td>\n    <td id="numpeople').concat(t.id,'" contenteditable>').concat(t.numberofpeople,'</td>\n    <td><button data-id="').concat(t.id,'" class="upd">UPDATE</button></td>\n    <td><button data-id="').concat(t.id,'" class="del">DELETE</button></td>\n    </tr>')}));for(var n=document.getElementsByClassName("del"),o=document.getElementsByClassName("upd"),c=0;c<n.length;c++)n[c].addEventListener("click",deleteBooking),o[c].addEventListener("click",updateBooking)}function deleteBooking(t){var e=t.target.dataset.id;fetch(urlB+"?id="+e,{method:"DELETE"}).then((function(t){return t.json()})).then((function(t){return getBookings()})).catch((function(t){return console.log(t)}))}function updateBooking(t){var e=t.target.dataset.id,n=document.getElementById("clientsname"+e).innerHTML,o=document.getElementById("clientslastname"+e).innerHTML,c=document.getElementById("phone"+e).innerHTML,d=document.getElementById("email"+e).innerHTML,a=document.getElementById("date"+e).innerHTML,i=document.getElementById("time"+e).innerHTML,r=document.getElementById("numpeople"+e).innerHTML,u=JSON.stringify({name:n,lastname:o,phone:c,email:d,date:a,time:i,numberofpeople:r,id:e});fetch(urlB+"?id="+e,{method:"PUT",headers:{"content-type":"application/json"},body:u}).then((function(t){return t.json()})).then((function(t){document.getElementById("message").innerHTML="UPDATED!",getBookings()})).catch((function(t){return console.log(t)}))}function displayMenu(t){var e=document.getElementById("pizza");e.innerHTML="";var n=document.getElementById("pasta");n.innerHTML="",t.forEach((function(t){"Pizzor"==t.category&&(e.innerHTML+='<tr>\n    \n            <td id="mealname'.concat(t.id,'" contenteditable>').concat(t.name,'</td>\n            <td id="category').concat(t.id,'">').concat(t.category,'</td>\n            <td id="description').concat(t.id,'" contenteditable>').concat(t.description,'</td>\n            <td id="price').concat(t.id,'" contenteditable>').concat(t.price,'</td>\n            <td><button data-id="').concat(t.id,'" class="update">UPDATE</button></td>\n            <td><button data-id="').concat(t.id,'" class="delete">DELETE</button></td>\n            </tr>')),"Pasta"==t.category&&(n.innerHTML+='<tr>\n               \n                <td id="mealname'.concat(t.id,'" contenteditable>').concat(t.name,'</td>\n                <td id="description').concat(t.id,'" contenteditable>').concat(t.description,'</td>\n                <td id="category').concat(t.id,'">').concat(t.category,'</td>\n                <td id="price').concat(t.id,'" contenteditable>').concat(t.price,'</td>\n                <td><button data-id="').concat(t.id,'" class="update">UPDATE</button></td>\n                <td><button data-id="').concat(t.id,'" class="delete">DELETE</button></td>\n                </tr>'))}));for(var o=document.getElementsByClassName("delete"),c=document.getElementsByClassName("update"),d=0;d<o.length;d++)o[d].addEventListener("click",deleteMeal),c[d].addEventListener("click",updateMeal)}function deleteMeal(t){var e=t.target.dataset.id;fetch(urlA+"?id="+e,{method:"DELETE"}).then((function(t){return t.json()})).then((function(t){return getMenu()})).catch((function(t){return console.log(t)}))}function updateMeal(t){var e=t.target.dataset.id,n=document.getElementById("mealname"+e).innerHTML,o=document.getElementById("description"+e).innerHTML,c=document.getElementById("category"+e).innerHTML,d=document.getElementById("price"+e).innerHTML,a=JSON.stringify({name:n,description:o,price:d,category:c,id:e});fetch(urlA+"?id="+e,{method:"PUT",headers:{"content-type":"application/json"},body:a}).then((function(t){return t.json()})).then((function(t){document.getElementById("message").innerHTML="UPDATED!",getMenu()})).catch((function(t){return console.log(t)}))}function clearForm(){mealNameInput.value="",categoryInput.value="",priceInput.value="",descriptionInput.value="",getMenu()}submitInput.addEventListener("click",addMeal),window.onload=init;